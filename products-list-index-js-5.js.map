{"version":3,"sources":["webpack:///./src/components/double-slider/index.js","webpack:///./src/pages/products/list/products-header.js","webpack:///./src/pages/products/list/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/components/sortable-table/index.js","webpack:///./src/utils/escape-html.js"],"names":["DoubleSlider","constructor","min","max","formatValue","value","selected","from","to","event","preventDefault","left","innerLeft","right","innerRight","width","this","subElements","inner","getBoundingClientRect","dragging","thumbLeft","newLeft","clientX","shiftX","parseFloat","thumbRight","style","progress","innerHTML","getValue","newRight","element","classList","remove","document","removeEventListener","onThumbPointerMove","onThumbPointerUp","dispatchEvent","CustomEvent","detail","bubbles","render","createElement","template","firstElementChild","ondragstart","getSubElements","initEventListeners","update","addEventListener","onThumbPointerDown","querySelectorAll","reduce","accum","subElement","dataset","destroy","rangeTotal","Math","floor","thumbElem","target","add","round","header","id","title","sortable","data","url","sortType","escapeHtml","category","subcategory","toLocaleString","Page","wrapper","initComponents","renderComponents","initEventListners","sliderContainer","productsContainer","SortableTable","sorted","order","start","end","step","placeholder","components","Object","keys","forEach","component","root","append","delayTimer","filter","price_gte","price_lte","updateComponents","filterName","clearTimeout","setTimeout","trim","title_like","filterStatus","status","setFilter","values","params","response","body","fetch","toString","err","FetchError","ok","errorText","statusText","json","error","message","Error","super","window","reason","alert","headerConfig","find","item","isSortLocally","column","closest","next","asc","desc","sort","async","bottom","documentElement","clientHeight","loading","loadData","addRows","URL","process","key","searchParams","delete","entries","set","renderRows","getHeader","getBody","map","join","getRow","row","length","onSortClick","onWindowScroll","fetchJson","sortLocally","sortOnServer","sortedData","sortData","direction","customSorting","a","b","localeCompare","caseFirst","push","rows","childNodes","string","replace"],"mappings":"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","file":"products-list-index-js-5.js","sourcesContent":["export default class DoubleSlider {\r\n  element;\r\n  subElements = {};\r\n\r\n  onThumbPointerMove = event => {\r\n    event.preventDefault();\r\n\r\n    const { left: innerLeft, right: innerRight, width } = this.subElements.inner.getBoundingClientRect();\r\n\r\n    if (this.dragging === this.subElements.thumbLeft) {\r\n      let newLeft = (event.clientX - innerLeft + this.shiftX) / width;\r\n\r\n      if (newLeft < 0) {\r\n        newLeft = 0;\r\n      }\r\n      newLeft *= 100;\r\n      const right = parseFloat(this.subElements.thumbRight.style.right);\r\n\r\n      if (newLeft + right > 100) {\r\n        newLeft = 100 - right;\r\n      }\r\n\r\n      this.dragging.style.left = this.subElements.progress.style.left = newLeft + '%';\r\n      this.subElements.from.innerHTML = this.formatValue(this.getValue().from);\r\n    }\r\n\r\n    if (this.dragging === this.subElements.thumbRight) {\r\n      let newRight = (innerRight - event.clientX - this.shiftX) / width;\r\n\r\n      if (newRight < 0) {\r\n        newRight = 0;\r\n      }\r\n      newRight *= 100;\r\n\r\n      const left = parseFloat(this.subElements.thumbLeft.style.left);\r\n\r\n      if (left + newRight > 100) {\r\n        newRight = 100 - left;\r\n      }\r\n      this.dragging.style.right = this.subElements.progress.style.right = newRight + '%';\r\n      this.subElements.to.innerHTML = this.formatValue(this.getValue().to);\r\n    }\r\n  };\r\n\r\n  onThumbPointerUp = () => {\r\n    this.element.classList.remove('range-slider_dragging');\r\n\r\n    document.removeEventListener('pointermove', this.onThumbPointerMove);\r\n    document.removeEventListener('pointerup', this.onThumbPointerUp);\r\n\r\n    this.element.dispatchEvent(new CustomEvent('range-select', {\r\n      detail: this.getValue(),\r\n      bubbles: true\r\n    }));\r\n  };\r\n\r\n  constructor({\r\n    min = 100,\r\n    max = 200,\r\n    formatValue = value => '$' + value,\r\n    selected = {\r\n      from: min,\r\n      to: max\r\n    }\r\n  } = {}) {\r\n    this.min = min;\r\n    this.max = max;\r\n    this.formatValue = formatValue;\r\n    this.selected = selected;\r\n\r\n    this.render();\r\n  }\r\n\r\n  get template() {\r\n    const { from, to } = this.selected;\r\n\r\n    return `<div class=\"range-slider\">\r\n      <span data-element=\"from\">${this.formatValue(from)}</span>\r\n      <div data-element=\"inner\" class=\"range-slider__inner\">\r\n        <span data-element=\"progress\" class=\"range-slider__progress\"></span>\r\n        <span data-element=\"thumbLeft\" class=\"range-slider__thumb-left\"></span>\r\n        <span data-element=\"thumbRight\" class=\"range-slider__thumb-right\"></span>\r\n      </div>\r\n      <span data-element=\"to\">${this.formatValue(to)}</span>\r\n    </div>`;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.element.ondragstart = () => false;\r\n\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    this.initEventListeners();\r\n\r\n    this.update();\r\n  }\r\n\r\n  initEventListeners() {\r\n    const { thumbLeft, thumbRight } = this.subElements;\r\n\r\n    thumbLeft.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\r\n    thumbRight.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    document.removeEventListener('pointermove', this.onThumbPointerMove);\r\n    document.removeEventListener('pointerup', this.onThumbPointerUp);\r\n  }\r\n\r\n  update() {\r\n    const rangeTotal = this.max - this.min;\r\n    const left = Math.floor((this.selected.from - this.min) / rangeTotal * 100) + '%';\r\n    const right = Math.floor((this.max - this.selected.to) / rangeTotal * 100) + '%';\r\n\r\n    this.subElements.progress.style.left = left;\r\n    this.subElements.progress.style.right = right;\r\n\r\n    this.subElements.thumbLeft.style.left = left;\r\n    this.subElements.thumbRight.style.right = right;\r\n  }\r\n\r\n  onThumbPointerDown(event) {\r\n    const thumbElem = event.target;\r\n\r\n    event.preventDefault();\r\n\r\n    const { left, right } = thumbElem.getBoundingClientRect();\r\n\r\n    if (thumbElem === this.subElements.thumbLeft) {\r\n      this.shiftX = right - event.clientX;\r\n    } else {\r\n      this.shiftX = left - event.clientX;\r\n    }\r\n\r\n    this.dragging = thumbElem;\r\n\r\n    this.element.classList.add('range-slider_dragging');\r\n\r\n    document.addEventListener('pointermove', this.onThumbPointerMove);\r\n    document.addEventListener('pointerup', this.onThumbPointerUp);\r\n  }\r\n\r\n  getValue() {\r\n    const rangeTotal = this.max - this.min;\r\n    const { left } = this.subElements.thumbLeft.style;\r\n    const { right } = this.subElements.thumbRight.style;\r\n\r\n    const from = Math.round(this.min + parseFloat(left) * 0.01 * rangeTotal);\r\n    const to = Math.round(this.max - parseFloat(right) * 0.01 * rangeTotal);\r\n\r\n    return { from, to };\r\n  }\r\n}\r\n","import escapeHtml from '../../../utils/escape-html.js';\r\n\r\nconst getSubcategoryTooltip = (category, subcategory) => `\r\n  <div class=\"sortable-table-tooltip\">\r\n    <span class=\"sortable-table-tooltip__category\">${category}</span> / <b class=\"sortable-table-tooltip__subcategory\">${subcategory}</b>\r\n  </div>\r\n`;\r\n\r\nconst header = [\r\n  {\r\n    id: 'images',\r\n    title: 'Фото',\r\n    sortable: false,\r\n    template: data => {\r\n      return `\r\n        <div class=\"sortable-table__cell\">\r\n          <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">\r\n        </div>\r\n      `;\r\n    }\r\n  },\r\n  {\r\n    id: 'title',\r\n    title: 'Название',\r\n    sortable: true,\r\n    sortType: 'string'\r\n  },\r\n  {\r\n    id: 'subcategory',\r\n    title: 'Категория',\r\n    sortable: false,\r\n    template: data => {\r\n      return `\r\n        <div class=\"sortable-table__cell\">\r\n          <span data-tooltip=\"${escapeHtml(getSubcategoryTooltip(data.category.title, data.title))}\">${data.title}</span>\r\n        </div>\r\n      `;\r\n    }\r\n  },\r\n  {\r\n    id: 'quantity',\r\n    title: 'Количество',\r\n    sortable: true,\r\n    sortType: 'number'\r\n  },\r\n  {\r\n    id: 'price',\r\n    title: 'Цена',\r\n    sortable: true,\r\n    sortType: 'number',\r\n    template: data => `\r\n      <div class=\"sortable-table__cell\">\r\n        $${data.toLocaleString('en-US')}\r\n      </div>\r\n    `\r\n  },\r\n  {\r\n    id: 'status',\r\n    title: 'Статус',\r\n    sortable: true,\r\n    sortType: 'number',\r\n    template: data => {\r\n      return `<div class=\"sortable-table__cell\">\r\n        ${data > 0 ? 'Активен' : 'Неактивен'}\r\n      </div>`;\r\n    }\r\n  },\r\n];\r\n\r\nexport default header;\r\n","import DoubleSlider from '../../../components/double-slider';\r\nimport SortableTable from '../../../components/sortable-table';\r\nimport header from './products-header.js';\r\n\r\nexport default class Page {\r\n  element;\r\n  subElements = {};\r\n  components = {};\r\n  filter = {\r\n    '_embed': 'subcategory.category',\r\n  };\r\n\r\n  get template() {\r\n    return `\r\n      <div class=\"products-list\">\r\n        <div class=\"content__top-panel\">\r\n          <h2 class=\"page-title\">Товары</h2>\r\n          <a href=\"/products/add\" class=\"button-primary\">Добавить товар</a>\r\n        </div>\r\n        <div class=\"content-box content-box_small\">\r\n          <form class=\"form-inline\">\r\n            <div class=\"form-group\">\r\n              <label class=\"form-label\">Сортировать по:</label>\r\n              <input type=\"text\" data-element=\"filterName\" class=\"form-control\" placeholder=\"Название товара\">\r\n            </div>\r\n            <div class=\"form-group\" data-element=\"sliderContainer\">\r\n              <label class=\"form-label\">Цена:</label>\r\n            </div>\r\n            <div class=\"form-group\">\r\n              <label class=\"form-label\">Статус:</label>\r\n              <select class=\"form-control\" data-element=\"filterStatus\">\r\n                <option value=\"\" selected=\"\">Любой</option>\r\n                <option value=\"1\">Активный</option>\r\n                <option value=\"0\">Неактивный</option>\r\n              </select>\r\n            </div>\r\n          </form>\r\n        </div>\r\n        <div data-element=\"productsContainer\" class=\"products-list__container\"></div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  render() {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.innerHTML = this.template;\r\n    this.element = wrapper.firstElementChild;\r\n\r\n    this.subElements = this.getSubElements();\r\n\r\n    this.initComponents();\r\n    this.renderComponents();\r\n    this.initEventListners();\r\n\r\n    return this.element;\r\n  }\r\n\r\n  initComponents() {    \r\n    const sliderContainer = new DoubleSlider({ min: 0, max: 4000 });\r\n\r\n    const productsContainer = new SortableTable(header, {\r\n      url: `api/rest/products?_embed=subcategory.category`,\r\n      sorted: {\r\n        id: 'title',\r\n        order: 'asc',\r\n      },\r\n      start: 0,\r\n      end: 30,\r\n      step: 30,\r\n      placeholder: `\r\n        <div>\r\n          <p>Не найдено товаров удовлетворяющих выбранному критерию</p>\r\n        </div>\r\n      `,\r\n    });\r\n\r\n    this.components = {\r\n      sliderContainer,\r\n      productsContainer,\r\n    };\r\n  }\r\n\r\n  renderComponents() {\r\n    Object.keys(this.components).forEach(component => {\r\n      const root = this.subElements[component];\r\n      const { element } = this.components[component];\r\n\r\n      root.append(element);\r\n    });\r\n  }\r\n\r\n  initEventListners() {\r\n    this.components.sliderContainer.element.addEventListener('range-select', event => {\r\n      const { from, to } = event.detail;\r\n      this.filter.price_gte = from;\r\n      this.filter.price_lte = to;\r\n      this.updateComponents();\r\n    });\r\n\r\n    let delayTimer;\r\n    this.subElements.filterName.addEventListener('keyup', () => {\r\n      clearTimeout(delayTimer);\r\n      delayTimer = setTimeout(() => {\r\n        const value = this.subElements.filterName.value.trim();\r\n        if (value !== this.filter.title_like) {\r\n          this.filter.title_like = value;\r\n          this.updateComponents();\r\n        }\r\n      }, 1000);\r\n    });\r\n\r\n    this.subElements.filterStatus.addEventListener('change', () => {\r\n      const { value } = this.subElements.filterStatus;\r\n      if (value === '') {\r\n        delete this.filter.status;\r\n      } else {\r\n        this.filter.status = value;\r\n      }\r\n      this.updateComponents();\r\n    });\r\n  }\r\n\r\n  updateComponents() {\r\n    this.components.productsContainer.setFilter(this.filter);\r\n  }\r\n\r\n  getSubElements() {\r\n    const elements = this.element.querySelectorAll('[data-element]');\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    for (const component of Object.values(this.components)) {\r\n      component.destroy();\r\n    }\r\n\r\n    this.remove();\r\n\r\n    this.element = null;\r\n    this.subElements = null;\r\n    this.components = null;\r\n  }\r\n}\r\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n","import fetchJson from '../../utils/fetch-json.js';\r\n\r\nexport default class SortableTable {\r\n  element;\r\n  subElements = {};\r\n  data = [];\r\n  loading = false;\r\n\r\n  onSortClick = event => {\r\n    const column = event.target.closest('[data-sortable]');\r\n    if (column) {\r\n      const { id, order } = column.dataset;\r\n      const next = {\r\n        asc: 'desc',\r\n        desc: 'asc',\r\n        '': 'desc',\r\n      };\r\n      this.sort(id, next[order]);\r\n    }\r\n  };\r\n\r\n  onWindowScroll = async () => {\r\n    const { bottom } = this.element.getBoundingClientRect();\r\n\r\n    if (bottom < document.documentElement.clientHeight && !this.loading && !this.isSortLocally) {\r\n      const { id, order } = this.sorted;\r\n      this.start = this.end;\r\n      this.end = this.start + this.step;\r\n      this.loading = true;\r\n      const data = await this.loadData(id, order, this.start, this.end);\r\n      this.addRows(data);\r\n      this.loading = false;\r\n    }\r\n  };\r\n\r\n  constructor(headerConfig = [], {\r\n    url = '',\r\n    sorted = {\r\n      id: headerConfig.find(item => item.sortable).id,\r\n      order: 'asc',\r\n    },\r\n    isSortLocally = false,\r\n    step = 20,\r\n    start = 0,\r\n    end = start + step,\r\n    placeholder = 'Не найдено',\r\n  } = {}) {\r\n    this.headerConfig = headerConfig;\r\n    this.url = new URL(url, process.env.BACKEND_URL);\r\n    this.sorted = sorted;\r\n    this.isSortLocally = isSortLocally;\r\n    this.step = step;\r\n    this.start = start;\r\n    this.end = end;\r\n    this.placeholder = placeholder;\r\n\r\n    this.render();\r\n  }\r\n\r\n  async setFilter(filter = {}) {\r\n    for (const key of this.url.searchParams.keys()) {\r\n      this.url.searchParams.delete(key);\r\n    }\r\n    Object.entries(filter).forEach(([key, value]) => {\r\n      this.url.searchParams.set(key, value);\r\n    });\r\n    const { id, order } = this.sorted;\r\n    this.start = 0;\r\n    this.end = this.start + this.step;\r\n    this.subElements.body.innerHTML = '';\r\n    this.data = await this.loadData(id, order, this.start, this.end);\r\n    this.renderRows(this.data);\r\n  }\r\n\r\n  get template() {\r\n    return `\r\n      <div class=\"sortable-table\">\r\n        <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\r\n          ${this.getHeader()}\r\n        </div>\r\n        <div data-element=\"body\" class=\"sortable-table__body\">\r\n          ${this.getBody()}\r\n        </div>\r\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\r\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">${this.placeholder}</div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getHeader() {\r\n    return this.headerConfig.map(item => `\r\n      <div class=\"sortable-table__cell\" data-id=\"${item.id}\" ${item.sortable ? 'data-sortable' : ''} data-order=\"${item.id === this.sorted.id ? this.sorted.order : ''}\">\r\n        <span>${item.title}</span>\r\n        <span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\r\n          <span class=\"sort-arrow\"></span>\r\n        </span>\r\n      </div>\r\n    `).join('');\r\n  }\r\n\r\n  getBody(data = []) {\r\n    return data.map(item => `\r\n      <a href=\"/products/${item.id}\" class=\"sortable-table__row\">\r\n        ${this.getRow(item)}\r\n      </a>\r\n    `).join('');\r\n  }\r\n\r\n  getRow(row) {\r\n    return this.headerConfig.map(item => item.template ? item.template(row[item.id]) : `\r\n      <div class=\"sortable-table__cell\">${row[item.id]}</div>\r\n    `).join('');\r\n  }\r\n\r\n  async render() {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.innerHTML = this.template;\r\n    this.element = wrapper.firstElementChild;\r\n    \r\n    this.subElements = this.getSubElements();\r\n\r\n    const { id, order } = this.sorted;\r\n    this.data = await this.loadData(id, order, this.start, this.end);\r\n    this.renderRows(this.data);\r\n\r\n    this.initEventListners();\r\n  }\r\n\r\n  renderRows(data) {\r\n    if (data.length) {\r\n      this.element.classList.remove('sortable-table_empty');\r\n      this.subElements.body.innerHTML = this.getBody(data);\r\n    } else {\r\n      this.element.classList.add('sortable-table_empty');\r\n    }\r\n  }\r\n\r\n  getSubElements() {\r\n    const elements = this.element.querySelectorAll('[data-element]');\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  initEventListners() {\r\n    this.subElements.header.addEventListener('pointerdown', this.onSortClick);\r\n    document.addEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n  async loadData(id, order, start, end) {\r\n    this.url.searchParams.set('_sort', id);\r\n    this.url.searchParams.set('_order', order);\r\n    this.url.searchParams.set('_start', start);\r\n    this.url.searchParams.set('_end', end);\r\n\r\n    this.element.classList.add('sortable-table_loading');\r\n    const data = await fetchJson(this.url);\r\n    this.element.classList.remove('sortable-table_loading');\r\n\r\n    return data;\r\n  }\r\n\r\n  sort(id, order) {\r\n    this.sorted = { id, order };\r\n    this.subElements.header.querySelectorAll('[data-sortable]').forEach(item => {\r\n      item.dataset.order = item.dataset.id === id ? order : '';\r\n    });\r\n    if (this.isSortLocally) {\r\n      this.sortLocally(id, order);\r\n    } else {\r\n      this.sortOnServer(id, order, 1, 1 + this.step);\r\n    }\r\n  }\r\n\r\n  sortLocally(id, order) {\r\n    const sortedData = this.sortData(id, order);\r\n    this.renderRows(sortedData);\r\n  }\r\n\r\n  async sortOnServer(id, order, start, end) {\r\n    this.data = await this.loadData(id, order, start, end);\r\n    this.renderRows(this.data);\r\n  }\r\n\r\n  sortData(id, order) {\r\n    const direction = ({ asc: 1, desc: -1 })[order];\r\n    if (!direction) return this.data;\r\n    const column = this.headerConfig.find(item => item.id === id);\r\n    const { sortType, customSorting } = column;\r\n\r\n    return [...this.data].sort((a, b) => {\r\n      switch (sortType) {\r\n        case 'string':\r\n          return direction * a[id].localeCompare(b[id], ['ru', 'en'], { caseFirst: 'upper' });\r\n        case 'number':\r\n          return direction * (a[id] - b[id]);\r\n        case 'custom':\r\n          return direction * customSorting(a, b);\r\n        default:\r\n          return direction * (a[id] - b[id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  addRows(data) {\r\n    this.data.push(...data);\r\n    const rows = document.createElement('div');\r\n    rows.innerHTML = this.getBody(data);\r\n    this.subElements.body.append(...rows.childNodes);\r\n  }\r\n\r\n  update(data) {\r\n    this.data = data;\r\n    this.renderRows(this.data);\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    document.removeEventListener('scroll', this.onWindowScroll);\r\n    this.subElements = {};\r\n  }\r\n}\r\n","export default string => string\r\n  .replace(/&/g, '&amp;')\r\n  .replace(/\"/g, '&quot;')\r\n  .replace(/'/g, '&#39;')\r\n  .replace(/</g, '&lt;')\r\n  .replace(/>/g, '&gt;');\r\n"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./src/components/sortable-list/index.js","webpack:///./src/components/notification/index.js","webpack:///./src/components/categories/index.js","webpack:///./src/pages/categories/index.js","webpack:///./src/utils/fetch-json.js"],"names":["SortableList","constructor","items","event","which","listItem","target","closest","preventDefault","this","dragStart","remove","clientX","clientY","moveDraggingItem","draggingItem","style","display","itemBelow","document","elementFromPoint","children","element","itemBelowIndex","indexOf","placeholderIndex","placeholder","after","before","dragStop","render","initEventListners","createElement","className","forEach","item","classList","add","append","addEventListener","onPointerDown","left","top","width","height","getBoundingClientRect","itemStartIndex","pointerOffset","x","y","onPointerMove","onPointerUp","itemStopIndex","replaceWith","removeEventListener","dispatchEvent","CustomEvent","bubbles","details","from","to","destroy","NotificationMessage","message","duration","type","success","error","Error","toFixed","wrapper","innerHTML","template","firstElementChild","show","body","current","activeComponent","clearTimeout","timeoutId","component","setTimeout","Categories","categories","category","createCategory","header","toggle","id","title","categoryElement","subcategoryList","createSubcategoryList","subcategories","querySelector","map","createSubcategoryItem","subcategory","count","Page","subElements","getSubElements","initComponents","renderComponents","data","loadCategories","categoriesContainer","components","url","URL","process","searchParams","set","fetchJson","Object","keys","root","notification","querySelectorAll","reduce","accum","subElement","dataset","values","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","status","super","window","reason","alert"],"mappings":"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","file":"categories-index-js-1.js","sourcesContent":["export default class SortableList {\r\n  element;\r\n\r\n  onPointerDown = event => {\r\n    if (event.which !== 1) return;\r\n    const listItem = event.target.closest('.sortable-list__item');\r\n\r\n    if (listItem) {\r\n      if (event.target.closest('[data-grab-handle]')) {\r\n        event.preventDefault();\r\n        this.dragStart(listItem, event);\r\n      }\r\n\r\n      if (event.target.closest('[data-delete-handle]')) {\r\n        event.preventDefault();\r\n        listItem.remove();\r\n      }\r\n    }\r\n  };\r\n\r\n  onPointerMove = ({ clientX, clientY }) => {\r\n    this.moveDraggingItem(clientX, clientY);\r\n\r\n    this.draggingItem.style.display = 'none';\r\n    const itemBelow = document.elementFromPoint(clientX, clientY)?.closest('.sortable-list__item');\r\n    this.draggingItem.style.display = '';\r\n    \r\n    const children = [...this.element.children];\r\n    const itemBelowIndex = children.indexOf(itemBelow);\r\n    const placeholderIndex = children.indexOf(this.placeholder);\r\n    if (itemBelowIndex === -1 || placeholderIndex === -1) return;\r\n\r\n    if (placeholderIndex < itemBelowIndex) {\r\n      itemBelow.after(this.placeholder);\r\n    } else {\r\n      itemBelow.before(this.placeholder);\r\n    }\r\n  };\r\n\r\n  onPointerUp = () => {\r\n    this.dragStop();\r\n  };\r\n\r\n  constructor({ items = [] } = {}) {\r\n    this.items = items;\r\n    \r\n    this.render();\r\n    this.initEventListners();\r\n  }\r\n\r\n  render() {\r\n    this.element = document.createElement('ul');\r\n    this.element.className = 'sortable-list';\r\n    this.items.forEach(item => item.classList.add('sortable-list__item'));\r\n    this.element.append(...this.items);\r\n  }\r\n\r\n  initEventListners() {\r\n    this.element.addEventListener('pointerdown', this.onPointerDown);\r\n  }\r\n\r\n  dragStart(listItem, { clientX, clientY }) {\r\n    const { left, top, width, height } = listItem.getBoundingClientRect();\r\n    this.itemStartIndex = [...this.element.children].indexOf(listItem);\r\n\r\n    this.placeholder = document.createElement('li');\r\n    this.placeholder.className = 'sortable-list__placeholder';\r\n    this.placeholder.style.width = width + 'px';\r\n    this.placeholder.style.height = height + 'px';\r\n\r\n    this.draggingItem = listItem;\r\n    this.draggingItem.classList.add('sortable-list__item_dragging');\r\n    this.draggingItem.style.width = width + 'px';\r\n    this.draggingItem.style.height = height + 'px';\r\n    this.draggingItem.before(this.placeholder);\r\n\r\n    this.element.append(this.draggingItem);\r\n\r\n    this.pointerOffset = {\r\n      x: clientX - left,\r\n      y: clientY - top,\r\n    };\r\n\r\n    this.moveDraggingItem(clientX, clientY);\r\n\r\n    document.addEventListener('pointermove', this.onPointerMove);\r\n    document.addEventListener('pointerup', this.onPointerUp);\r\n  }\r\n\r\n  moveDraggingItem(clientX, clientY) {\r\n    this.draggingItem.style.left = clientX - this.pointerOffset.x + 'px';\r\n    this.draggingItem.style.top = clientY - this.pointerOffset.y + 'px';\r\n  }\r\n\r\n  dragStop() {\r\n    const itemStopIndex = [...this.element.children].indexOf(this.placeholder);\r\n    this.placeholder.replaceWith(this.draggingItem);\r\n    this.draggingItem.classList.remove('sortable-list__item_dragging');\r\n\r\n    this.draggingItem.style.left = '';\r\n    this.draggingItem.style.top = '';\r\n    this.draggingItem.style.width = '';\r\n    this.draggingItem.style.height = '';\r\n\r\n    document.removeEventListener('pointermove', this.onPointerMove);\r\n    document.removeEventListener('pointerup', this.onPointerUp);\r\n\r\n    this.draggingItem = null;\r\n    \r\n    if (itemStopIndex !== this.itemStartIndex) {\r\n      this.element.dispatchEvent(new CustomEvent('sortable-list-reorder', {\r\n        bubbles: true,\r\n        details: {\r\n          from: this.itemStartIndex,\r\n          to: itemStopIndex,\r\n        }\r\n      }))\r\n    }\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    document.removeEventListener('pointermove', this.onPointerMove);\r\n    document.removeEventListener('pointerup', this.onPointerMove);\r\n    this.element = null;\r\n  }\r\n}\r\n","export default class NotificationMessage {\r\n  static activeComponent = {\r\n    timeoutId: null,\r\n    component: null,\r\n  }; \r\n\r\n  constructor(message = '', {\r\n    duration = 2000,\r\n    type = 'success',\r\n  } = {}) {\r\n    const types = {\r\n      success: 'success',\r\n      error: 'error',\r\n    };\r\n    this.type = types[type];\r\n    if (!this.type) throw new Error('Invalid type specified');\r\n\r\n    this.message = message;\r\n    this.duration = duration;\r\n\r\n    this.render();\r\n  }\r\n\r\n  get template() {\r\n    return `\r\n      <div class=\"notification ${this.type}\" style=\"--value:${(this.duration / 1000).toFixed(0)}s\">\r\n        <div class=\"inner-wrapper\">\r\n          <div class=\"notification-body\">${this.message}</div>\r\n        </div>\r\n        <div class=\"timer\"></div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  render() {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.innerHTML = this.template;\r\n    this.element = wrapper.firstElementChild;\r\n  }\r\n\r\n  show(target = document.body) {\r\n    const current = this.constructor.activeComponent;\r\n    clearTimeout(current.timeoutId);\r\n    current.component?.remove();\r\n    current.component = target.append(this.element);\r\n    current.timeoutId = setTimeout(() => this.remove(), this.duration);\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n  }\r\n}\r\n","import SortableList from '../sortable-list'\r\n\r\nexport default class Categories {\r\n  element;\r\n\r\n  constructor(categories = []) {\r\n    this.categories = categories;\r\n\r\n    this.render();\r\n    this.initEventListners();\r\n  }\r\n\r\n  render() {\r\n    this.element = document.createElement('div');\r\n    this.element.className = 'categories';\r\n\r\n    this.categories.forEach(category => {\r\n      this.element.append(this.createCategory(category));\r\n    });\r\n  }\r\n\r\n  initEventListners() {\r\n    this.element.addEventListener('click', event => {\r\n      const header = event.target.closest('.category__header');\r\n\r\n      if (header) {\r\n        const category = header.closest('.category');\r\n        category.classList.toggle('category_open');\r\n      }\r\n    });\r\n  }\r\n\r\n  createCategory(category) {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.innerHTML = `\r\n      <div class=\"category category_open\" data-id=\"${category.id}\">\r\n        <header class=\"category__header\">\r\n          ${category.title}\r\n        </header>\r\n        <div class=\"category__body\">\r\n          <div class=\"subcategory-list\"></div>\r\n        </div>\r\n      </div>\r\n    `;\r\n    const categoryElement = wrapper.firstElementChild;\r\n    const subcategoryList = this.createSubcategoryList(category.subcategories);\r\n    categoryElement.querySelector('.subcategory-list').append(subcategoryList);\r\n    return categoryElement;\r\n  }\r\n\r\n  createSubcategoryList(subcategories = []) {\r\n    const sortableList = new SortableList({\r\n      items: subcategories.map(item => this.createSubcategoryItem(item)),\r\n    });\r\n    return sortableList.element;\r\n  }\r\n\r\n  createSubcategoryItem(subcategory) {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.innerHTML = `\r\n      <li class=\"categories__sortable-list-item sortable-list__item\" data-grab-handle=\"\" data-id=\"${subcategory.id}\">\r\n        <strong>${subcategory.title}</strong>\r\n        <span><b>${subcategory.count}</b> products</span>\r\n      </li>\r\n    `;\r\n    return wrapper.firstElementChild;\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n  }\r\n}","import Categories from '../../components/categories';\r\nimport NotificationMessage from '../../components/notification';\r\n\r\nimport fetchJson from '../../utils/fetch-json.js';\r\n\r\nexport default class Page {\r\n  element;\r\n  subElements = {};\r\n  components = {};\r\n\r\n  get template() {\r\n    return `\r\n      <div class=\"categories\">\r\n        <div class=\"content__top-panel\">\r\n          <h1 class=\"page-title\">Категории товаров</h1>\r\n        </div>\r\n        <div data-element=\"categoriesContainer\"></div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  async render() {\r\n    const wrapper = document.createElement('div');\r\n    wrapper.innerHTML = this.template;\r\n    this.element = wrapper.firstElementChild;\r\n\r\n    this.subElements = this.getSubElements();\r\n\r\n    await this.initComponents();\r\n    this.renderComponents();\r\n    this.initEventListners();\r\n\r\n    return this.element;\r\n  }\r\n\r\n  async initComponents() {\r\n    const data = await this.loadCategories();\r\n    const categoriesContainer = new Categories(data);\r\n\r\n    this.components = {\r\n      categoriesContainer,\r\n    };\r\n  }\r\n\r\n  loadCategories() {\r\n    const url = new URL('/api/rest/categories', process.env.BACKEND_URL);\r\n    url.searchParams.set('_sort', 'weight');\r\n    url.searchParams.set('_refs', 'subcategory');\r\n    return fetchJson(url);\r\n  }\r\n\r\n  renderComponents() {\r\n    Object.keys(this.components).forEach(component => {\r\n      const root = this.subElements[component];\r\n      const { element } = this.components[component];\r\n\r\n      root.append(element);\r\n    });\r\n  }\r\n\r\n  initEventListners() {\r\n    const notification = new NotificationMessage('Порядок изменен', { duration: 2000, type: 'success' });\r\n    this.element.addEventListener('sortable-list-reorder', event => {\r\n      notification.show();\r\n    })\r\n  }\r\n\r\n  getSubElements() {\r\n    const elements = this.element.querySelectorAll('[data-element]');\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n  }\r\n\r\n  destroy() {\r\n    for (const component of Object.values(this.components)) {\r\n      component.destroy();\r\n    }\r\n\r\n    this.remove();\r\n\r\n    this.element = null;\r\n    this.subElements = null;\r\n    this.components = null;\r\n  }\r\n}\r\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n"],"sourceRoot":""}